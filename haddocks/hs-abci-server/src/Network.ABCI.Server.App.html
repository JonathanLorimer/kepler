<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_BAL05rZsBKLBUE5uPsTi0T"><span id="%24tag2con_BAL05rZsBKLBUE5uPsTi0T"><span id="%24con2tag_BAL05rZsBKLBUE5uPsTi0T"></span></span></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.ABCI.Server.App</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier">App</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#runApp"><span class="hs-identifier">runApp</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#transformApp"><span class="hs-identifier">transformApp</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#withProto"><span class="hs-identifier">withProto</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Middleware"><span class="hs-identifier">Middleware</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier">MessageType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#demoteRequestType"><span class="hs-identifier">demoteRequestType</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier">msgTypeKey</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier">Request</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#hashRequest"><span class="hs-identifier">hashRequest</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier">Response</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier">LPByteStrings</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#decodeLengthPrefix"><span class="hs-identifier">decodeLengthPrefix</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#encodeLengthPrefix"><span class="hs-identifier">encodeLengthPrefix</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(?~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens.Wrapped</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Wrapped</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">_Unwrapped'</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">object</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withObject</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.:)</span></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>                                                       </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ProtoLens</span></span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PL</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ProtoLens.Encoding.Bytes</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getVarInt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putVarInt</span></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">runBuilder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runParser</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">signedInt64ToWord</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>                                                       </span><span class="annot"><span class="hs-identifier">wordToSignedInt64</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.String.Conversions</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cs</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html"><span class="hs-identifier">Network.ABCI.Server.App.DecodeError</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html#DecodeError"><span class="hs-identifier">DecodeError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html"><span class="hs-identifier">Network.ABCI.Server.App.DecodeError</span></a></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DecodeError</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.ABCI.Types.Messages.Request</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Request</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.ABCI.Types.Messages.Response</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Response</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hashWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Hash.Algorithms</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SHA256</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">convert</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray.HexString</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Hex</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Default.Class</span></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ProtoLens.Message</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Message</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defMessage</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ProtoLens.Prism</span></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Proto.Types</span></span><span>                          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PT</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Proto.Types_Fields</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PT</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Used to parametrize Request and Response types</span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="MessageType"><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-var">MessageType</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MTEcho"><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTFlush"><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTInfo"><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTSetOption"><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTInitChain"><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTQuery"><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTBeginBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTCheckTx"><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTDeliverTx"><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTEndBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MTCommit"><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203155"><span id="local-6989586621679203157"><span class="annot"><span class="annottext">MessageType -&gt; MessageType -&gt; Bool
(MessageType -&gt; MessageType -&gt; Bool)
-&gt; (MessageType -&gt; MessageType -&gt; Bool) -&gt; Eq MessageType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MessageType -&gt; MessageType -&gt; Bool
$c/= :: MessageType -&gt; MessageType -&gt; Bool
== :: MessageType -&gt; MessageType -&gt; Bool
$c== :: MessageType -&gt; MessageType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203139"><span id="local-6989586621679203141"><span id="local-6989586621679203143"><span id="local-6989586621679203145"><span id="local-6989586621679203147"><span id="local-6989586621679203149"><span id="local-6989586621679203151"><span class="annot"><span class="annottext">Eq MessageType
Eq MessageType =&gt;
(MessageType -&gt; MessageType -&gt; Ordering)
-&gt; (MessageType -&gt; MessageType -&gt; Bool)
-&gt; (MessageType -&gt; MessageType -&gt; Bool)
-&gt; (MessageType -&gt; MessageType -&gt; Bool)
-&gt; (MessageType -&gt; MessageType -&gt; Bool)
-&gt; (MessageType -&gt; MessageType -&gt; MessageType)
-&gt; (MessageType -&gt; MessageType -&gt; MessageType)
-&gt; Ord MessageType
MessageType -&gt; MessageType -&gt; Bool
MessageType -&gt; MessageType -&gt; Ordering
MessageType -&gt; MessageType -&gt; MessageType
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: MessageType -&gt; MessageType -&gt; MessageType
$cmin :: MessageType -&gt; MessageType -&gt; MessageType
max :: MessageType -&gt; MessageType -&gt; MessageType
$cmax :: MessageType -&gt; MessageType -&gt; MessageType
&gt;= :: MessageType -&gt; MessageType -&gt; Bool
$c&gt;= :: MessageType -&gt; MessageType -&gt; Bool
&gt; :: MessageType -&gt; MessageType -&gt; Bool
$c&gt; :: MessageType -&gt; MessageType -&gt; Bool
&lt;= :: MessageType -&gt; MessageType -&gt; Bool
$c&lt;= :: MessageType -&gt; MessageType -&gt; Bool
&lt; :: MessageType -&gt; MessageType -&gt; Bool
$c&lt; :: MessageType -&gt; MessageType -&gt; Bool
compare :: MessageType -&gt; MessageType -&gt; Ordering
$ccompare :: MessageType -&gt; MessageType -&gt; Ordering
$cp1Ord :: Eq MessageType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203122"><span id="local-6989586621679203124"><span id="local-6989586621679203126"><span id="local-6989586621679203128"><span id="local-6989586621679203130"><span id="local-6989586621679203132"><span id="local-6989586621679203134"><span id="local-6989586621679203136"><span class="annot"><span class="annottext">Int -&gt; MessageType
MessageType -&gt; Int
MessageType -&gt; [MessageType]
MessageType -&gt; MessageType
MessageType -&gt; MessageType -&gt; [MessageType]
MessageType -&gt; MessageType -&gt; MessageType -&gt; [MessageType]
(MessageType -&gt; MessageType)
-&gt; (MessageType -&gt; MessageType)
-&gt; (Int -&gt; MessageType)
-&gt; (MessageType -&gt; Int)
-&gt; (MessageType -&gt; [MessageType])
-&gt; (MessageType -&gt; MessageType -&gt; [MessageType])
-&gt; (MessageType -&gt; MessageType -&gt; [MessageType])
-&gt; (MessageType -&gt; MessageType -&gt; MessageType -&gt; [MessageType])
-&gt; Enum MessageType
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: MessageType -&gt; MessageType -&gt; MessageType -&gt; [MessageType]
$cenumFromThenTo :: MessageType -&gt; MessageType -&gt; MessageType -&gt; [MessageType]
enumFromTo :: MessageType -&gt; MessageType -&gt; [MessageType]
$cenumFromTo :: MessageType -&gt; MessageType -&gt; [MessageType]
enumFromThen :: MessageType -&gt; MessageType -&gt; [MessageType]
$cenumFromThen :: MessageType -&gt; MessageType -&gt; [MessageType]
enumFrom :: MessageType -&gt; [MessageType]
$cenumFrom :: MessageType -&gt; [MessageType]
fromEnum :: MessageType -&gt; Int
$cfromEnum :: MessageType -&gt; Int
toEnum :: Int -&gt; MessageType
$ctoEnum :: Int -&gt; MessageType
pred :: MessageType -&gt; MessageType
$cpred :: MessageType -&gt; MessageType
succ :: MessageType -&gt; MessageType
$csucc :: MessageType -&gt; MessageType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier hs-type">msgTypeKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-69"></span><span id="msgTypeKey"><span class="annot"><span class="annottext">msgTypeKey :: MessageType -&gt; String
</span><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier hs-var hs-var">msgTypeKey</span></a></span></span><span> </span><span id="local-6989586621679203120"><span class="annot"><span class="annottext">m :: MessageType
</span><a href="#local-6989586621679203120"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="#local-6989586621679203120"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;echo&quot;</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;flush&quot;</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;info&quot;</span></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;setOption&quot;</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;initChain&quot;</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;query&quot;</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;beginBlock&quot;</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;checkTx&quot;</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;deliverTx&quot;</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;endBlock&quot;</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;commit&quot;</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Network.ABCI.Server.App.html#demoteRequestType"><span class="hs-identifier hs-type">demoteRequestType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203119"><span class="annot"><a href="#local-6989586621679203119"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203119"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span>
</span><span id="line-83"></span><span id="demoteRequestType"><span class="annot"><span class="annottext">demoteRequestType :: Request t -&gt; MessageType
</span><a href="Network.ABCI.Server.App.html#demoteRequestType"><span class="hs-identifier hs-var hs-var">demoteRequestType</span></a></span></span><span> </span><span id="local-6989586621679203118"><span class="annot"><span class="annottext">req :: Request t
</span><a href="#local-6989586621679203118"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Request t
</span><a href="#local-6989586621679203118"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-type">RequestEcho</span></a></span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-type">RequestInfo</span></a></span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-type">RequestSetOption</span></a></span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-type">RequestQuery</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-type">RequestCheckTx</span></a></span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-type">RequestFlush</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-type">RequestInitChain</span></a></span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-type">RequestBeginBlock</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-type">RequestDeliverTx</span></a></span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-type">RequestEndBlock</span></a></span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-type">RequestCommit</span></a></span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-type">reqParseJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679203347"><span class="annot"><a href="#local-6989586621679203347"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679203348"><span class="annot"><a href="#local-6989586621679203348"><span class="hs-identifier hs-type">inner</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679203348"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203348"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203347"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203347"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span id="reqParseJSON"><span class="annot"><span class="annottext">reqParseJSON :: MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var hs-var">reqParseJSON</span></a></span></span><span> </span><span id="local-6989586621679203105"><span class="annot"><span class="annottext">msgType :: MessageType
</span><a href="#local-6989586621679203105"><span class="hs-identifier hs-var">msgType</span></a></span></span><span> </span><span id="local-6989586621679203104"><span class="annot"><span class="annottext">ctr :: inner -&gt; Request t
</span><a href="#local-6989586621679203104"><span class="hs-identifier hs-var">ctr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (Request t)) -&gt; Value -&gt; Parser (Request t)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;req:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203103"><span class="hs-identifier hs-var">expectedType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (Request t)) -&gt; Value -&gt; Parser (Request t))
-&gt; (Object -&gt; Parser (Request t)) -&gt; Value -&gt; Parser (Request t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679203102"><span class="annot"><span class="annottext">v :: Object
</span><a href="#local-6989586621679203102"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679203101"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203101"><span class="hs-identifier hs-var">actualType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679203102"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser String
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203101"><span class="hs-identifier hs-var">actualType</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203103"><span class="hs-identifier hs-var">expectedType</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">inner -&gt; Request t
</span><a href="#local-6989586621679203104"><span class="hs-identifier hs-var">ctr</span></a></span><span> </span><span class="annot"><span class="annottext">(inner -&gt; Request t) -&gt; Parser inner -&gt; Parser (Request t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679203102"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser inner
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;message&quot;</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser (Request t)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser (Request t)) -&gt; String -&gt; Parser (Request t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expected `type` to equal: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203103"><span class="hs-identifier hs-var">expectedType</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203101"><span class="hs-identifier hs-var">actualType</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679203103"><span class="annot"><span class="annottext">expectedType :: String
</span><a href="#local-6989586621679203103"><span class="hs-identifier hs-var hs-var">expectedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; String
</span><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier hs-var">msgTypeKey</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="#local-6989586621679203105"><span class="hs-identifier hs-var">msgType</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679203283"><span id="local-6989586621679203284"><span class="annot"><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-type">resParseJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679203284"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203284"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203283"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203283"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-106"></span><span id="resParseJSON"><span class="annot"><span class="annottext">resParseJSON :: MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var hs-var">resParseJSON</span></a></span></span><span> </span><span id="local-6989586621679203097"><span class="annot"><span class="annottext">msgType :: MessageType
</span><a href="#local-6989586621679203097"><span class="hs-identifier hs-var">msgType</span></a></span></span><span> </span><span id="local-6989586621679203096"><span class="annot"><span class="annottext">ctr :: inner -&gt; Response t
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">ctr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (Response t)) -&gt; Value -&gt; Parser (Response t)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;res:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203095"><span class="hs-identifier hs-var">expectedType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (Response t)) -&gt; Value -&gt; Parser (Response t))
-&gt; (Object -&gt; Parser (Response t)) -&gt; Value -&gt; Parser (Response t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679203094"><span class="annot"><span class="annottext">v :: Object
</span><a href="#local-6989586621679203094"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679203093"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203093"><span class="hs-identifier hs-var">actualType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679203094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser String
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203093"><span class="hs-identifier hs-var">actualType</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-string">&quot;exception&quot;</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Exception -&gt; Response t
forall (m :: MessageType). Exception -&gt; Response m
</span><a href="Network.ABCI.Server.App.html#ResponseException"><span class="hs-identifier hs-var">ResponseException</span></a></span><span> </span><span class="annot"><span class="annottext">(Exception -&gt; Response t)
-&gt; Parser Exception -&gt; Parser (Response t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679203094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser Exception
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;message&quot;</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203093"><span class="hs-identifier hs-var">actualType</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203095"><span class="hs-identifier hs-var">expectedType</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">inner -&gt; Response t
</span><a href="#local-6989586621679203096"><span class="hs-identifier hs-var">ctr</span></a></span><span> </span><span class="annot"><span class="annottext">(inner -&gt; Response t) -&gt; Parser inner -&gt; Parser (Response t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679203094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Text -&gt; Parser inner
forall a. FromJSON a =&gt; Object -&gt; Text -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;message&quot;</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser (Response t)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser (Response t)) -&gt; String -&gt; Parser (Response t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;expected `type` to equal: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203095"><span class="hs-identifier hs-var">expectedType</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;, but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679203093"><span class="hs-identifier hs-var">actualType</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679203095"><span class="annot"><span class="annottext">expectedType :: String
</span><a href="#local-6989586621679203095"><span class="hs-identifier hs-var hs-var">expectedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; String
</span><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier hs-var">msgTypeKey</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="#local-6989586621679203097"><span class="hs-identifier hs-var">msgType</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679203361"><span class="annot"><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-type">reqResToJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679203361"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679203361"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span></span><span>
</span><span id="line-117"></span><span id="reqResToJSON"><span class="annot"><span class="annottext">reqResToJSON :: MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var hs-var">reqResToJSON</span></a></span></span><span> </span><span id="local-6989586621679203090"><span class="annot"><span class="annottext">msgType :: MessageType
</span><a href="#local-6989586621679203090"><span class="hs-identifier hs-var">msgType</span></a></span></span><span> </span><span id="local-6989586621679203089"><span class="annot"><span class="annottext">message :: inner
</span><a href="#local-6989586621679203089"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; inner -&gt; Value
forall inner. ToJSON inner =&gt; Text -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON%27"><span class="hs-identifier hs-var">reqResToJSON'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. ConvertibleStrings a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">cs</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; String
</span><a href="Network.ABCI.Server.App.html#msgTypeKey"><span class="hs-identifier hs-var">msgTypeKey</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="#local-6989586621679203090"><span class="hs-identifier hs-var">msgType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">inner
</span><a href="#local-6989586621679203089"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679203375"><span class="annot"><a href="Network.ABCI.Server.App.html#reqResToJSON%27"><span class="hs-identifier hs-type">reqResToJSON'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679203375"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679203375"><span class="hs-identifier hs-type">inner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span></span><span>
</span><span id="line-120"></span><span id="reqResToJSON%27"><span class="annot"><span class="annottext">reqResToJSON' :: Text -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON%27"><span class="hs-identifier hs-var hs-var">reqResToJSON'</span></a></span></span><span> </span><span id="local-6989586621679203087"><span class="annot"><span class="annottext">msgType :: Text
</span><a href="#local-6989586621679203087"><span class="hs-identifier hs-var">msgType</span></a></span></span><span> </span><span id="local-6989586621679203086"><span class="annot"><span class="annottext">message :: inner
</span><a href="#local-6989586621679203086"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679203087"><span class="hs-identifier hs-var">msgType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">inner -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">inner
</span><a href="#local-6989586621679203086"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- Request</span><span>
</span><span id="line-125"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Note: that there are 3 type of connection made by tendermint to the ABCI application:</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- * Info/Query Connection, sends only: Echo, Info and SetOption requests</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- * Mempool Connection, sends only: CheckTx and Flush requests</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- * Consensus Connection, InitChain,: BeginBlock, DeliverTx, EndBlock and  Commit requests</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- https://github.com/tendermint/tendermint/blob/v0.32.2/proxy/app_conn.go#L11-L41</span><span>
</span><span id="line-132"></span><span class="hs-keyword">data</span><span> </span><span id="Request"><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-var">Request</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203083"><span class="annot"><a href="#local-6989586621679203083"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">-- Info/Query Connection</span><span>
</span><span id="line-134"></span><span>  </span><span id="RequestEcho"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-var">RequestEcho</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.Echo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="RequestInfo"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-var">RequestInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span id="RequestSetOption"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-var">RequestSetOption</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.SetOption</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span id="RequestQuery"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-var">RequestQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.Query</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-comment">-- Mempool Connection</span><span>
</span><span id="line-139"></span><span>  </span><span id="RequestCheckTx"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-var">RequestCheckTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.CheckTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span id="RequestFlush"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-var">RequestFlush</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.Flush</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- Consensus Connection</span><span>
</span><span id="line-142"></span><span>  </span><span id="RequestInitChain"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-var">RequestInitChain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.InitChain</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="RequestBeginBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-var">RequestBeginBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.BeginBlock</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span id="RequestDeliverTx"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-var">RequestDeliverTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.DeliverTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span id="RequestEndBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-var">RequestEndBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.EndBlock</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span id="RequestCommit"><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-var">RequestCommit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request.Commit</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679203082"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203075"><span id="local-6989586621679203077"><span id="local-6989586621679203079"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679203082"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679203073"><span class="annot"><span class="annottext">toJSON :: Request t -&gt; Value
</span><a href="#local-6989586621679203073"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-type">RequestEcho</span></a></span><span> </span><span id="local-6989586621679203072"><span class="annot"><span class="annottext">v :: Echo
</span><a href="#local-6989586621679203072"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Echo -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Echo
</span><a href="#local-6989586621679203072"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-type">RequestInfo</span></a></span><span> </span><span id="local-6989586621679203071"><span class="annot"><span class="annottext">v :: Info
</span><a href="#local-6989586621679203071"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Info -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679203071"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-type">RequestSetOption</span></a></span><span> </span><span id="local-6989586621679203070"><span class="annot"><span class="annottext">v :: SetOption
</span><a href="#local-6989586621679203070"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; SetOption -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption
</span><a href="#local-6989586621679203070"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-type">RequestQuery</span></a></span><span> </span><span id="local-6989586621679203069"><span class="annot"><span class="annottext">v :: Query
</span><a href="#local-6989586621679203069"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Query -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679203069"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-type">RequestCheckTx</span></a></span><span> </span><span id="local-6989586621679203068"><span class="annot"><span class="annottext">v :: CheckTx
</span><a href="#local-6989586621679203068"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; CheckTx -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx
</span><a href="#local-6989586621679203068"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-type">RequestFlush</span></a></span><span> </span><span id="local-6989586621679203067"><span class="annot"><span class="annottext">v :: Flush
</span><a href="#local-6989586621679203067"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Flush -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Flush
</span><a href="#local-6989586621679203067"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-type">RequestInitChain</span></a></span><span> </span><span id="local-6989586621679203066"><span class="annot"><span class="annottext">v :: InitChain
</span><a href="#local-6989586621679203066"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; InitChain -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain
</span><a href="#local-6989586621679203066"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-type">RequestBeginBlock</span></a></span><span> </span><span id="local-6989586621679203065"><span class="annot"><span class="annottext">v :: BeginBlock
</span><a href="#local-6989586621679203065"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; BeginBlock -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock
</span><a href="#local-6989586621679203065"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-type">RequestDeliverTx</span></a></span><span> </span><span id="local-6989586621679203064"><span class="annot"><span class="annottext">v :: DeliverTx
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; DeliverTx -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx
</span><a href="#local-6989586621679203064"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-type">RequestEndBlock</span></a></span><span> </span><span id="local-6989586621679203063"><span class="annot"><span class="annottext">v :: EndBlock
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; EndBlock -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock
</span><a href="#local-6989586621679203063"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-type">RequestCommit</span></a></span><span> </span><span id="local-6989586621679203062"><span class="annot"><span class="annottext">v :: Commit
</span><a href="#local-6989586621679203062"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Commit -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Commit
</span><a href="#local-6989586621679203062"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203059"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203057"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTEcho)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Echo -&gt; Request 'MTEcho) -&gt; Value -&gt; Parser (Request 'MTEcho)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Echo -&gt; Request 'MTEcho
</span><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-var">RequestEcho</span></a></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203053"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203052"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTInfo)
</span><a href="#local-6989586621679203052"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Info -&gt; Request 'MTInfo) -&gt; Value -&gt; Parser (Request 'MTInfo)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Request 'MTInfo
</span><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-var">RequestInfo</span></a></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203049"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203048"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTSetOption)
</span><a href="#local-6989586621679203048"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (SetOption -&gt; Request 'MTSetOption)
-&gt; Value
-&gt; Parser (Request 'MTSetOption)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption -&gt; Request 'MTSetOption
</span><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-var">RequestSetOption</span></a></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203045"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203044"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTQuery)
</span><a href="#local-6989586621679203044"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Query -&gt; Request 'MTQuery)
-&gt; Value
-&gt; Parser (Request 'MTQuery)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query -&gt; Request 'MTQuery
</span><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-var">RequestQuery</span></a></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203041"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203040"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTCheckTx)
</span><a href="#local-6989586621679203040"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (CheckTx -&gt; Request 'MTCheckTx)
-&gt; Value
-&gt; Parser (Request 'MTCheckTx)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx -&gt; Request 'MTCheckTx
</span><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-var">RequestCheckTx</span></a></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203037"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203036"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTFlush)
</span><a href="#local-6989586621679203036"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Flush -&gt; Request 'MTFlush)
-&gt; Value
-&gt; Parser (Request 'MTFlush)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Flush -&gt; Request 'MTFlush
</span><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-var">RequestFlush</span></a></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203033"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203032"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTInitChain)
</span><a href="#local-6989586621679203032"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (InitChain -&gt; Request 'MTInitChain)
-&gt; Value
-&gt; Parser (Request 'MTInitChain)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain -&gt; Request 'MTInitChain
</span><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-var">RequestInitChain</span></a></span><span>
</span><span id="line-169"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203029"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203028"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTBeginBlock)
</span><a href="#local-6989586621679203028"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (BeginBlock -&gt; Request 'MTBeginBlock)
-&gt; Value
-&gt; Parser (Request 'MTBeginBlock)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock -&gt; Request 'MTBeginBlock
</span><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-var">RequestBeginBlock</span></a></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203025"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203024"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTDeliverTx)
</span><a href="#local-6989586621679203024"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (DeliverTx -&gt; Request 'MTDeliverTx)
-&gt; Value
-&gt; Parser (Request 'MTDeliverTx)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx -&gt; Request 'MTDeliverTx
</span><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-var">RequestDeliverTx</span></a></span><span>
</span><span id="line-171"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203021"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203020"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTEndBlock)
</span><a href="#local-6989586621679203020"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (EndBlock -&gt; Request 'MTEndBlock)
-&gt; Value
-&gt; Parser (Request 'MTEndBlock)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock -&gt; Request 'MTEndBlock
</span><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-var">RequestEndBlock</span></a></span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203017"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679203016"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Request 'MTCommit)
</span><a href="#local-6989586621679203016"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Commit -&gt; Request 'MTCommit)
-&gt; Value
-&gt; Parser (Request 'MTCommit)
forall (t :: MessageType) inner.
FromJSON inner =&gt;
MessageType -&gt; (inner -&gt; Request t) -&gt; Value -&gt; Parser (Request t)
</span><a href="Network.ABCI.Server.App.html#reqParseJSON"><span class="hs-identifier hs-var">reqParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Commit -&gt; Request 'MTCommit
</span><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-var">RequestCommit</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Network.ABCI.Server.App.html#hashRequest"><span class="hs-identifier hs-type">hashRequest</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203015"><span class="annot"><a href="#local-6989586621679203015"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-176"></span><span>     </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203015"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hex.HexString</span></span><span>
</span><span id="line-178"></span><span id="hashRequest"><span class="annot"><span class="annottext">hashRequest :: Request t -&gt; HexString
</span><a href="Network.ABCI.Server.App.html#hashRequest"><span class="hs-identifier hs-var hs-var">hashRequest</span></a></span></span><span> </span><span id="local-6989586621679203014"><span class="annot"><span class="annottext">req :: Request t
</span><a href="#local-6989586621679203014"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679203013"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679203013"><span class="hs-identifier hs-var">requestBytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Request t
</span><a href="#local-6989586621679203014"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-type">RequestEcho</span></a></span><span> </span><span id="local-6989586621679203012"><span class="annot"><span class="annottext">v :: Echo
</span><a href="#local-6989586621679203012"><span class="hs-identifier hs-var">v</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestEcho -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestEcho -&gt; ByteString) -&gt; RequestEcho -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Echo
</span><a href="#local-6989586621679203012"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Echo -&gt; Getting RequestEcho Echo RequestEcho -&gt; RequestEcho
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestEcho Echo RequestEcho
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-type">RequestFlush</span></a></span><span> </span><span id="local-6989586621679203009"><span class="annot"><span class="annottext">v :: Flush
</span><a href="#local-6989586621679203009"><span class="hs-identifier hs-var">v</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestFlush -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestFlush -&gt; ByteString) -&gt; RequestFlush -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Flush
</span><a href="#local-6989586621679203009"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Flush -&gt; Getting RequestFlush Flush RequestFlush -&gt; RequestFlush
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestFlush Flush RequestFlush
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-type">RequestInfo</span></a></span><span> </span><span id="local-6989586621679203008"><span class="annot"><span class="annottext">v :: Info
</span><a href="#local-6989586621679203008"><span class="hs-identifier hs-var">v</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestInfo -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestInfo -&gt; ByteString) -&gt; RequestInfo -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679203008"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Getting RequestInfo Info RequestInfo -&gt; RequestInfo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestInfo Info RequestInfo
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-type">RequestSetOption</span></a></span><span> </span><span id="local-6989586621679203007"><span class="annot"><span class="annottext">v :: SetOption
</span><a href="#local-6989586621679203007"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestSetOption -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestSetOption -&gt; ByteString) -&gt; RequestSetOption -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SetOption
</span><a href="#local-6989586621679203007"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption
-&gt; Getting RequestSetOption SetOption RequestSetOption
-&gt; RequestSetOption
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestSetOption SetOption RequestSetOption
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-type">RequestInitChain</span></a></span><span> </span><span id="local-6989586621679203006"><span class="annot"><span class="annottext">v :: InitChain
</span><a href="#local-6989586621679203006"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestInitChain -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestInitChain -&gt; ByteString) -&gt; RequestInitChain -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InitChain
</span><a href="#local-6989586621679203006"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain
-&gt; Getting RequestInitChain InitChain RequestInitChain
-&gt; RequestInitChain
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestInitChain InitChain RequestInitChain
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-type">RequestQuery</span></a></span><span> </span><span id="local-6989586621679203005"><span class="annot"><span class="annottext">v :: Query
</span><a href="#local-6989586621679203005"><span class="hs-identifier hs-var">v</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestQuery -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestQuery -&gt; ByteString) -&gt; RequestQuery -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679203005"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Query -&gt; Getting RequestQuery Query RequestQuery -&gt; RequestQuery
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestQuery Query RequestQuery
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-type">RequestBeginBlock</span></a></span><span> </span><span id="local-6989586621679203004"><span class="annot"><span class="annottext">v :: BeginBlock
</span><a href="#local-6989586621679203004"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestBeginBlock -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestBeginBlock -&gt; ByteString)
-&gt; RequestBeginBlock -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BeginBlock
</span><a href="#local-6989586621679203004"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock
-&gt; Getting RequestBeginBlock BeginBlock RequestBeginBlock
-&gt; RequestBeginBlock
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestBeginBlock BeginBlock RequestBeginBlock
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-type">RequestCheckTx</span></a></span><span> </span><span id="local-6989586621679203003"><span class="annot"><span class="annottext">v :: CheckTx
</span><a href="#local-6989586621679203003"><span class="hs-identifier hs-var">v</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestCheckTx -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestCheckTx -&gt; ByteString) -&gt; RequestCheckTx -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CheckTx
</span><a href="#local-6989586621679203003"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx
-&gt; Getting RequestCheckTx CheckTx RequestCheckTx -&gt; RequestCheckTx
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestCheckTx CheckTx RequestCheckTx
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-type">RequestDeliverTx</span></a></span><span> </span><span id="local-6989586621679203002"><span class="annot"><span class="annottext">v :: DeliverTx
</span><a href="#local-6989586621679203002"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestDeliverTx -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestDeliverTx -&gt; ByteString) -&gt; RequestDeliverTx -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DeliverTx
</span><a href="#local-6989586621679203002"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx
-&gt; Getting RequestDeliverTx DeliverTx RequestDeliverTx
-&gt; RequestDeliverTx
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestDeliverTx DeliverTx RequestDeliverTx
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-type">RequestEndBlock</span></a></span><span> </span><span id="local-6989586621679203001"><span class="annot"><span class="annottext">v :: EndBlock
</span><a href="#local-6989586621679203001"><span class="hs-identifier hs-var">v</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestEndBlock -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestEndBlock -&gt; ByteString) -&gt; RequestEndBlock -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndBlock
</span><a href="#local-6989586621679203001"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock
-&gt; Getting RequestEndBlock EndBlock RequestEndBlock
-&gt; RequestEndBlock
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestEndBlock EndBlock RequestEndBlock
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-type">RequestCommit</span></a></span><span> </span><span id="local-6989586621679203000"><span class="annot"><span class="annottext">v :: Commit
</span><a href="#local-6989586621679203000"><span class="hs-identifier hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestCommit -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span> </span><span class="annot"><span class="annottext">(RequestCommit -&gt; ByteString) -&gt; RequestCommit -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commit
</span><a href="#local-6989586621679203000"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Commit
-&gt; Getting RequestCommit Commit RequestCommit -&gt; RequestCommit
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting RequestCommit Commit RequestCommit
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteArrayAccess ByteString =&gt; ByteString -&gt; HexString
forall ba. ByteArrayAccess ba =&gt; ba -&gt; HexString
</span><span class="hs-identifier hs-var">Hex.fromBytes</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HexString)
-&gt; (Digest SHA256 -&gt; ByteString) -&gt; Digest SHA256 -&gt; HexString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Digest SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA256 -&gt; HexString) -&gt; Digest SHA256 -&gt; HexString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHA256 -&gt; ByteString -&gt; Digest SHA256
forall ba alg.
(ByteArrayAccess ba, HashAlgorithm alg) =&gt;
alg -&gt; ba -&gt; Digest alg
</span><span class="hs-identifier hs-var">hashWith</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679203013"><span class="hs-identifier hs-var">requestBytes</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679203216"><span class="annot"><a href="Network.ABCI.Server.App.html#withProto"><span class="hs-identifier hs-type">withProto</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203300"><span class="annot"><a href="#local-6989586621679203300"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203300"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679203216"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Value</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679203216"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-197"></span><span id="withProto"><span class="annot"><span class="annottext">withProto :: (forall (t :: MessageType). Request t -&gt; a) -&gt; Request'Value -&gt; a
</span><a href="Network.ABCI.Server.App.html#withProto"><span class="hs-identifier hs-var hs-var">withProto</span></a></span></span><span> </span><span id="local-6989586621679202996"><span class="annot"><span class="annottext">f :: forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679202995"><span class="annot"><span class="annottext">value :: Request'Value
</span><a href="#local-6989586621679202995"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Request'Value
</span><a href="#local-6989586621679202995"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Echo</span></span><span> </span><span id="local-6989586621679202993"><span class="annot"><span class="annottext">echo :: RequestEcho
</span><a href="#local-6989586621679202993"><span class="hs-identifier hs-var">echo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTEcho -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTEcho -&gt; a) -&gt; Request 'MTEcho -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Echo -&gt; Request 'MTEcho
</span><a href="Network.ABCI.Server.App.html#RequestEcho"><span class="hs-identifier hs-var">RequestEcho</span></a></span><span> </span><span class="annot"><span class="annottext">(Echo -&gt; Request 'MTEcho) -&gt; Echo -&gt; Request 'MTEcho
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestEcho
</span><a href="#local-6989586621679202993"><span class="hs-identifier hs-var">echo</span></a></span><span> </span><span class="annot"><span class="annottext">RequestEcho -&gt; Getting Echo RequestEcho Echo -&gt; Echo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Echo RequestEcho Echo
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Flush</span></span><span> </span><span id="local-6989586621679202991"><span class="annot"><span class="annottext">flush :: RequestFlush
</span><a href="#local-6989586621679202991"><span class="hs-identifier hs-var">flush</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTFlush -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTFlush -&gt; a) -&gt; Request 'MTFlush -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Flush -&gt; Request 'MTFlush
</span><a href="Network.ABCI.Server.App.html#RequestFlush"><span class="hs-identifier hs-var">RequestFlush</span></a></span><span> </span><span class="annot"><span class="annottext">(Flush -&gt; Request 'MTFlush) -&gt; Flush -&gt; Request 'MTFlush
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestFlush
</span><a href="#local-6989586621679202991"><span class="hs-identifier hs-var">flush</span></a></span><span> </span><span class="annot"><span class="annottext">RequestFlush -&gt; Getting Flush RequestFlush Flush -&gt; Flush
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Flush RequestFlush Flush
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Info</span></span><span> </span><span id="local-6989586621679202989"><span class="annot"><span class="annottext">info :: RequestInfo
</span><a href="#local-6989586621679202989"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTInfo -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTInfo -&gt; a) -&gt; Request 'MTInfo -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Request 'MTInfo
</span><a href="Network.ABCI.Server.App.html#RequestInfo"><span class="hs-identifier hs-var">RequestInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Request 'MTInfo) -&gt; Info -&gt; Request 'MTInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestInfo
</span><a href="#local-6989586621679202989"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">RequestInfo -&gt; Getting Info RequestInfo Info -&gt; Info
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Info RequestInfo Info
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'SetOption</span></span><span> </span><span id="local-6989586621679202987"><span class="annot"><span class="annottext">setOption :: RequestSetOption
</span><a href="#local-6989586621679202987"><span class="hs-identifier hs-var">setOption</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTSetOption -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTSetOption -&gt; a) -&gt; Request 'MTSetOption -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SetOption -&gt; Request 'MTSetOption
</span><a href="Network.ABCI.Server.App.html#RequestSetOption"><span class="hs-identifier hs-var">RequestSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">(SetOption -&gt; Request 'MTSetOption)
-&gt; SetOption -&gt; Request 'MTSetOption
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestSetOption
</span><a href="#local-6989586621679202987"><span class="hs-identifier hs-var">setOption</span></a></span><span> </span><span class="annot"><span class="annottext">RequestSetOption
-&gt; Getting SetOption RequestSetOption SetOption -&gt; SetOption
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting SetOption RequestSetOption SetOption
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'InitChain</span></span><span> </span><span id="local-6989586621679202985"><span class="annot"><span class="annottext">initChain :: RequestInitChain
</span><a href="#local-6989586621679202985"><span class="hs-identifier hs-var">initChain</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTInitChain -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTInitChain -&gt; a) -&gt; Request 'MTInitChain -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InitChain -&gt; Request 'MTInitChain
</span><a href="Network.ABCI.Server.App.html#RequestInitChain"><span class="hs-identifier hs-var">RequestInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">(InitChain -&gt; Request 'MTInitChain)
-&gt; InitChain -&gt; Request 'MTInitChain
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestInitChain
</span><a href="#local-6989586621679202985"><span class="hs-identifier hs-var">initChain</span></a></span><span> </span><span class="annot"><span class="annottext">RequestInitChain
-&gt; Getting InitChain RequestInitChain InitChain -&gt; InitChain
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting InitChain RequestInitChain InitChain
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Query</span></span><span> </span><span id="local-6989586621679202983"><span class="annot"><span class="annottext">query :: RequestQuery
</span><a href="#local-6989586621679202983"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTQuery -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTQuery -&gt; a) -&gt; Request 'MTQuery -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Query -&gt; Request 'MTQuery
</span><a href="Network.ABCI.Server.App.html#RequestQuery"><span class="hs-identifier hs-var">RequestQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(Query -&gt; Request 'MTQuery) -&gt; Query -&gt; Request 'MTQuery
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestQuery
</span><a href="#local-6989586621679202983"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">RequestQuery -&gt; Getting Query RequestQuery Query -&gt; Query
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Query RequestQuery Query
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'BeginBlock</span></span><span> </span><span id="local-6989586621679202981"><span class="annot"><span class="annottext">beginBlock :: RequestBeginBlock
</span><a href="#local-6989586621679202981"><span class="hs-identifier hs-var">beginBlock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTBeginBlock -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTBeginBlock -&gt; a) -&gt; Request 'MTBeginBlock -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BeginBlock -&gt; Request 'MTBeginBlock
</span><a href="Network.ABCI.Server.App.html#RequestBeginBlock"><span class="hs-identifier hs-var">RequestBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(BeginBlock -&gt; Request 'MTBeginBlock)
-&gt; BeginBlock -&gt; Request 'MTBeginBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestBeginBlock
</span><a href="#local-6989586621679202981"><span class="hs-identifier hs-var">beginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">RequestBeginBlock
-&gt; Getting BeginBlock RequestBeginBlock BeginBlock -&gt; BeginBlock
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting BeginBlock RequestBeginBlock BeginBlock
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'CheckTx</span></span><span> </span><span id="local-6989586621679202979"><span class="annot"><span class="annottext">checkTx :: RequestCheckTx
</span><a href="#local-6989586621679202979"><span class="hs-identifier hs-var">checkTx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTCheckTx -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTCheckTx -&gt; a) -&gt; Request 'MTCheckTx -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CheckTx -&gt; Request 'MTCheckTx
</span><a href="Network.ABCI.Server.App.html#RequestCheckTx"><span class="hs-identifier hs-var">RequestCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckTx -&gt; Request 'MTCheckTx) -&gt; CheckTx -&gt; Request 'MTCheckTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestCheckTx
</span><a href="#local-6989586621679202979"><span class="hs-identifier hs-var">checkTx</span></a></span><span> </span><span class="annot"><span class="annottext">RequestCheckTx -&gt; Getting CheckTx RequestCheckTx CheckTx -&gt; CheckTx
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting CheckTx RequestCheckTx CheckTx
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'DeliverTx</span></span><span> </span><span id="local-6989586621679202977"><span class="annot"><span class="annottext">deliverTx :: RequestDeliverTx
</span><a href="#local-6989586621679202977"><span class="hs-identifier hs-var">deliverTx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTDeliverTx -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTDeliverTx -&gt; a) -&gt; Request 'MTDeliverTx -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DeliverTx -&gt; Request 'MTDeliverTx
</span><a href="Network.ABCI.Server.App.html#RequestDeliverTx"><span class="hs-identifier hs-var">RequestDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">(DeliverTx -&gt; Request 'MTDeliverTx)
-&gt; DeliverTx -&gt; Request 'MTDeliverTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestDeliverTx
</span><a href="#local-6989586621679202977"><span class="hs-identifier hs-var">deliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">RequestDeliverTx
-&gt; Getting DeliverTx RequestDeliverTx DeliverTx -&gt; DeliverTx
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DeliverTx RequestDeliverTx DeliverTx
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'EndBlock</span></span><span> </span><span id="local-6989586621679202975"><span class="annot"><span class="annottext">endBlock :: RequestEndBlock
</span><a href="#local-6989586621679202975"><span class="hs-identifier hs-var">endBlock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTEndBlock -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTEndBlock -&gt; a) -&gt; Request 'MTEndBlock -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndBlock -&gt; Request 'MTEndBlock
</span><a href="Network.ABCI.Server.App.html#RequestEndBlock"><span class="hs-identifier hs-var">RequestEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(EndBlock -&gt; Request 'MTEndBlock)
-&gt; EndBlock -&gt; Request 'MTEndBlock
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestEndBlock
</span><a href="#local-6989586621679202975"><span class="hs-identifier hs-var">endBlock</span></a></span><span> </span><span class="annot"><span class="annottext">RequestEndBlock
-&gt; Getting EndBlock RequestEndBlock EndBlock -&gt; EndBlock
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting EndBlock RequestEndBlock EndBlock
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Commit</span></span><span> </span><span id="local-6989586621679202973"><span class="annot"><span class="annottext">commit :: RequestCommit
</span><a href="#local-6989586621679202973"><span class="hs-identifier hs-var">commit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request 'MTCommit -&gt; a
forall (t :: MessageType). Request t -&gt; a
</span><a href="#local-6989586621679202996"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Request 'MTCommit -&gt; a) -&gt; Request 'MTCommit -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commit -&gt; Request 'MTCommit
</span><a href="Network.ABCI.Server.App.html#RequestCommit"><span class="hs-identifier hs-var">RequestCommit</span></a></span><span> </span><span class="annot"><span class="annottext">(Commit -&gt; Request 'MTCommit) -&gt; Commit -&gt; Request 'MTCommit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestCommit
</span><a href="#local-6989586621679202973"><span class="hs-identifier hs-var">commit</span></a></span><span> </span><span class="annot"><span class="annottext">RequestCommit -&gt; Getting Commit RequestCommit Commit -&gt; Commit
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Commit RequestCommit Commit
forall s. Wrapped s =&gt; Iso' (Unwrapped s) s
</span><span class="hs-identifier hs-var">_Unwrapped'</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- Response</span><span>
</span><span id="line-212"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">data</span><span> </span><span id="Response"><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-var">Response</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202972"><span class="annot"><a href="#local-6989586621679202972"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span id="ResponseEcho"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEcho"><span class="hs-identifier hs-var">ResponseEcho</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Echo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="ResponseFlush"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseFlush"><span class="hs-identifier hs-var">ResponseFlush</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Flush</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span id="ResponseInfo"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInfo"><span class="hs-identifier hs-var">ResponseInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="ResponseSetOption"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseSetOption"><span class="hs-identifier hs-var">ResponseSetOption</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.SetOption</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span id="ResponseInitChain"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInitChain"><span class="hs-identifier hs-var">ResponseInitChain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.InitChain</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="ResponseQuery"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseQuery"><span class="hs-identifier hs-var">ResponseQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Query</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span id="ResponseBeginBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseBeginBlock"><span class="hs-identifier hs-var">ResponseBeginBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.BeginBlock</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span id="ResponseCheckTx"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCheckTx"><span class="hs-identifier hs-var">ResponseCheckTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.CheckTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span id="ResponseDeliverTx"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseDeliverTx"><span class="hs-identifier hs-var">ResponseDeliverTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.DeliverTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span id="ResponseEndBlock"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEndBlock"><span class="hs-identifier hs-var">ResponseEndBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.EndBlock</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="ResponseCommit"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCommit"><span class="hs-identifier hs-var">ResponseCommit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Commit</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span id="ResponseException"><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseException"><span class="hs-identifier hs-var">ResponseException</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203377"><span class="annot"><a href="#local-6989586621679203377"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response.Exception</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203377"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621679202960"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202953"><span id="local-6989586621679202955"><span id="local-6989586621679202957"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679202960"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621679202952"><span class="annot"><span class="annottext">toJSON :: Response t -&gt; Value
</span><a href="#local-6989586621679202952"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEcho"><span class="hs-identifier hs-type">ResponseEcho</span></a></span><span> </span><span id="local-6989586621679202951"><span class="annot"><span class="annottext">v :: Echo
</span><a href="#local-6989586621679202951"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Echo -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Echo
</span><a href="#local-6989586621679202951"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseFlush"><span class="hs-identifier hs-type">ResponseFlush</span></a></span><span> </span><span id="local-6989586621679202950"><span class="annot"><span class="annottext">v :: Flush
</span><a href="#local-6989586621679202950"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Flush -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Flush
</span><a href="#local-6989586621679202950"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInfo"><span class="hs-identifier hs-type">ResponseInfo</span></a></span><span> </span><span id="local-6989586621679202949"><span class="annot"><span class="annottext">v :: Info
</span><a href="#local-6989586621679202949"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Info -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679202949"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseSetOption"><span class="hs-identifier hs-type">ResponseSetOption</span></a></span><span> </span><span id="local-6989586621679202948"><span class="annot"><span class="annottext">v :: SetOption
</span><a href="#local-6989586621679202948"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; SetOption -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption
</span><a href="#local-6989586621679202948"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInitChain"><span class="hs-identifier hs-type">ResponseInitChain</span></a></span><span> </span><span id="local-6989586621679202947"><span class="annot"><span class="annottext">v :: InitChain
</span><a href="#local-6989586621679202947"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; InitChain -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain
</span><a href="#local-6989586621679202947"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseQuery"><span class="hs-identifier hs-type">ResponseQuery</span></a></span><span> </span><span id="local-6989586621679202946"><span class="annot"><span class="annottext">v :: Query
</span><a href="#local-6989586621679202946"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Query -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679202946"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseBeginBlock"><span class="hs-identifier hs-type">ResponseBeginBlock</span></a></span><span> </span><span id="local-6989586621679202945"><span class="annot"><span class="annottext">v :: BeginBlock
</span><a href="#local-6989586621679202945"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; BeginBlock -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock
</span><a href="#local-6989586621679202945"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCheckTx"><span class="hs-identifier hs-type">ResponseCheckTx</span></a></span><span> </span><span id="local-6989586621679202944"><span class="annot"><span class="annottext">v :: CheckTx
</span><a href="#local-6989586621679202944"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; CheckTx -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx
</span><a href="#local-6989586621679202944"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseDeliverTx"><span class="hs-identifier hs-type">ResponseDeliverTx</span></a></span><span> </span><span id="local-6989586621679202943"><span class="annot"><span class="annottext">v :: DeliverTx
</span><a href="#local-6989586621679202943"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; DeliverTx -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx
</span><a href="#local-6989586621679202943"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEndBlock"><span class="hs-identifier hs-type">ResponseEndBlock</span></a></span><span> </span><span id="local-6989586621679202942"><span class="annot"><span class="annottext">v :: EndBlock
</span><a href="#local-6989586621679202942"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; EndBlock -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock
</span><a href="#local-6989586621679202942"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCommit"><span class="hs-identifier hs-type">ResponseCommit</span></a></span><span> </span><span id="local-6989586621679202941"><span class="annot"><span class="annottext">v :: Commit
</span><a href="#local-6989586621679202941"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType -&gt; Commit -&gt; Value
forall inner. ToJSON inner =&gt; MessageType -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON"><span class="hs-identifier hs-var">reqResToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Commit
</span><a href="#local-6989586621679202941"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseException"><span class="hs-identifier hs-type">ResponseException</span></a></span><span> </span><span id="local-6989586621679202940"><span class="annot"><span class="annottext">v :: Exception
</span><a href="#local-6989586621679202940"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exception -&gt; Value
forall inner. ToJSON inner =&gt; Text -&gt; inner -&gt; Value
</span><a href="Network.ABCI.Server.App.html#reqResToJSON%27"><span class="hs-identifier hs-var">reqResToJSON'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;exception&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exception
</span><a href="#local-6989586621679202940"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202937"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202936"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTEcho)
</span><a href="#local-6989586621679202936"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Echo -&gt; Response 'MTEcho) -&gt; Value -&gt; Parser (Response 'MTEcho)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-var">MTEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Echo -&gt; Response 'MTEcho
</span><a href="Network.ABCI.Server.App.html#ResponseEcho"><span class="hs-identifier hs-var">ResponseEcho</span></a></span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202933"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202932"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTFlush)
</span><a href="#local-6989586621679202932"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Flush -&gt; Response 'MTFlush)
-&gt; Value
-&gt; Parser (Response 'MTFlush)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-var">MTFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Flush -&gt; Response 'MTFlush
</span><a href="Network.ABCI.Server.App.html#ResponseFlush"><span class="hs-identifier hs-var">ResponseFlush</span></a></span><span>
</span><span id="line-244"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202929"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202928"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTInfo)
</span><a href="#local-6989586621679202928"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Info -&gt; Response 'MTInfo) -&gt; Value -&gt; Parser (Response 'MTInfo)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-var">MTInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Response 'MTInfo
</span><a href="Network.ABCI.Server.App.html#ResponseInfo"><span class="hs-identifier hs-var">ResponseInfo</span></a></span><span>
</span><span id="line-245"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202925"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202924"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTSetOption)
</span><a href="#local-6989586621679202924"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (SetOption -&gt; Response 'MTSetOption)
-&gt; Value
-&gt; Parser (Response 'MTSetOption)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-var">MTSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption -&gt; Response 'MTSetOption
</span><a href="Network.ABCI.Server.App.html#ResponseSetOption"><span class="hs-identifier hs-var">ResponseSetOption</span></a></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202921"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202920"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTInitChain)
</span><a href="#local-6989586621679202920"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (InitChain -&gt; Response 'MTInitChain)
-&gt; Value
-&gt; Parser (Response 'MTInitChain)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-var">MTInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain -&gt; Response 'MTInitChain
</span><a href="Network.ABCI.Server.App.html#ResponseInitChain"><span class="hs-identifier hs-var">ResponseInitChain</span></a></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202917"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202916"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTQuery)
</span><a href="#local-6989586621679202916"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Query -&gt; Response 'MTQuery)
-&gt; Value
-&gt; Parser (Response 'MTQuery)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-var">MTQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query -&gt; Response 'MTQuery
</span><a href="Network.ABCI.Server.App.html#ResponseQuery"><span class="hs-identifier hs-var">ResponseQuery</span></a></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202913"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202912"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTBeginBlock)
</span><a href="#local-6989586621679202912"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (BeginBlock -&gt; Response 'MTBeginBlock)
-&gt; Value
-&gt; Parser (Response 'MTBeginBlock)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-var">MTBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock -&gt; Response 'MTBeginBlock
</span><a href="Network.ABCI.Server.App.html#ResponseBeginBlock"><span class="hs-identifier hs-var">ResponseBeginBlock</span></a></span><span>
</span><span id="line-249"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202909"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202908"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTCheckTx)
</span><a href="#local-6989586621679202908"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (CheckTx -&gt; Response 'MTCheckTx)
-&gt; Value
-&gt; Parser (Response 'MTCheckTx)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-var">MTCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx -&gt; Response 'MTCheckTx
</span><a href="Network.ABCI.Server.App.html#ResponseCheckTx"><span class="hs-identifier hs-var">ResponseCheckTx</span></a></span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202905"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202904"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTDeliverTx)
</span><a href="#local-6989586621679202904"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (DeliverTx -&gt; Response 'MTDeliverTx)
-&gt; Value
-&gt; Parser (Response 'MTDeliverTx)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-var">MTDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx -&gt; Response 'MTDeliverTx
</span><a href="Network.ABCI.Server.App.html#ResponseDeliverTx"><span class="hs-identifier hs-var">ResponseDeliverTx</span></a></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202901"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202900"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTEndBlock)
</span><a href="#local-6989586621679202900"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (EndBlock -&gt; Response 'MTEndBlock)
-&gt; Value
-&gt; Parser (Response 'MTEndBlock)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-var">MTEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock -&gt; Response 'MTEndBlock
</span><a href="Network.ABCI.Server.App.html#ResponseEndBlock"><span class="hs-identifier hs-var">ResponseEndBlock</span></a></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679202897"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202896"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Response 'MTCommit)
</span><a href="#local-6989586621679202896"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageType
-&gt; (Commit -&gt; Response 'MTCommit)
-&gt; Value
-&gt; Parser (Response 'MTCommit)
forall inner (t :: MessageType).
FromJSON inner =&gt;
MessageType
-&gt; (inner -&gt; Response t) -&gt; Value -&gt; Parser (Response t)
</span><a href="Network.ABCI.Server.App.html#resParseJSON"><span class="hs-identifier hs-var">resParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">MessageType
</span><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-var">MTCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Commit -&gt; Response 'MTCommit
</span><a href="Network.ABCI.Server.App.html#ResponseCommit"><span class="hs-identifier hs-var">ResponseCommit</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEcho"><span class="hs-identifier hs-type">MTEcho</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202893"><span class="annot"><span class="annottext">def :: Response 'MTEcho
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Echo -&gt; Response 'MTEcho
</span><a href="Network.ABCI.Server.App.html#ResponseEcho"><span class="hs-identifier hs-var">ResponseEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Echo
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-255"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTFlush"><span class="hs-identifier hs-type">MTFlush</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202890"><span class="annot"><span class="annottext">def :: Response 'MTFlush
</span><a href="#local-6989586621679202890"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flush -&gt; Response 'MTFlush
</span><a href="Network.ABCI.Server.App.html#ResponseFlush"><span class="hs-identifier hs-var">ResponseFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Flush
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInfo"><span class="hs-identifier hs-type">MTInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202888"><span class="annot"><span class="annottext">def :: Response 'MTInfo
</span><a href="#local-6989586621679202888"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Info -&gt; Response 'MTInfo
</span><a href="Network.ABCI.Server.App.html#ResponseInfo"><span class="hs-identifier hs-var">ResponseInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTSetOption"><span class="hs-identifier hs-type">MTSetOption</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202886"><span class="annot"><span class="annottext">def :: Response 'MTSetOption
</span><a href="#local-6989586621679202886"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SetOption -&gt; Response 'MTSetOption
</span><a href="Network.ABCI.Server.App.html#ResponseSetOption"><span class="hs-identifier hs-var">ResponseSetOption</span></a></span><span> </span><span class="annot"><span class="annottext">SetOption
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-258"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTInitChain"><span class="hs-identifier hs-type">MTInitChain</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202884"><span class="annot"><span class="annottext">def :: Response 'MTInitChain
</span><a href="#local-6989586621679202884"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitChain -&gt; Response 'MTInitChain
</span><a href="Network.ABCI.Server.App.html#ResponseInitChain"><span class="hs-identifier hs-var">ResponseInitChain</span></a></span><span> </span><span class="annot"><span class="annottext">InitChain
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTQuery"><span class="hs-identifier hs-type">MTQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202882"><span class="annot"><span class="annottext">def :: Response 'MTQuery
</span><a href="#local-6989586621679202882"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query -&gt; Response 'MTQuery
</span><a href="Network.ABCI.Server.App.html#ResponseQuery"><span class="hs-identifier hs-var">ResponseQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTBeginBlock"><span class="hs-identifier hs-type">MTBeginBlock</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202880"><span class="annot"><span class="annottext">def :: Response 'MTBeginBlock
</span><a href="#local-6989586621679202880"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BeginBlock -&gt; Response 'MTBeginBlock
</span><a href="Network.ABCI.Server.App.html#ResponseBeginBlock"><span class="hs-identifier hs-var">ResponseBeginBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BeginBlock
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCheckTx"><span class="hs-identifier hs-type">MTCheckTx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202878"><span class="annot"><span class="annottext">def :: Response 'MTCheckTx
</span><a href="#local-6989586621679202878"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckTx -&gt; Response 'MTCheckTx
</span><a href="Network.ABCI.Server.App.html#ResponseCheckTx"><span class="hs-identifier hs-var">ResponseCheckTx</span></a></span><span> </span><span class="annot"><span class="annottext">CheckTx
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTDeliverTx"><span class="hs-identifier hs-type">MTDeliverTx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202876"><span class="annot"><span class="annottext">def :: Response 'MTDeliverTx
</span><a href="#local-6989586621679202876"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeliverTx -&gt; Response 'MTDeliverTx
</span><a href="Network.ABCI.Server.App.html#ResponseDeliverTx"><span class="hs-identifier hs-var">ResponseDeliverTx</span></a></span><span> </span><span class="annot"><span class="annottext">DeliverTx
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTEndBlock"><span class="hs-identifier hs-type">MTEndBlock</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202874"><span class="annot"><span class="annottext">def :: Response 'MTEndBlock
</span><a href="#local-6989586621679202874"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndBlock -&gt; Response 'MTEndBlock
</span><a href="Network.ABCI.Server.App.html#ResponseEndBlock"><span class="hs-identifier hs-var">ResponseEndBlock</span></a></span><span> </span><span class="annot"><span class="annottext">EndBlock
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Network.ABCI.Server.App.html#MTCommit"><span class="hs-identifier hs-type">MTCommit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679202872"><span class="annot"><span class="annottext">def :: Response 'MTCommit
</span><a href="#local-6989586621679202872"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Commit -&gt; Response 'MTCommit
</span><a href="Network.ABCI.Server.App.html#ResponseCommit"><span class="hs-identifier hs-var">ResponseCommit</span></a></span><span> </span><span class="annot"><span class="annottext">Commit
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Translates type-safe 'Response' GADT to the unsafe</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   auto-generated 'Proto.Response'</span><span>
</span><span id="line-268"></span><span id="local-6989586621679203217"><span class="annot"><a href="Network.ABCI.Server.App.html#toProto"><span class="hs-identifier hs-type">toProto</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203217"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PT.Response</span></span></span><span>
</span><span id="line-269"></span><span id="toProto"><span class="annot"><span class="annottext">toProto :: Response t -&gt; Response
</span><a href="Network.ABCI.Server.App.html#toProto"><span class="hs-identifier hs-var hs-var">toProto</span></a></span></span><span> </span><span id="local-6989586621679202870"><span class="annot"><span class="annottext">r :: Response t
</span><a href="#local-6989586621679202870"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Response t
</span><a href="#local-6989586621679202870"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEcho"><span class="hs-identifier hs-type">ResponseEcho</span></a></span><span> </span><span id="local-6989586621679202869"><span class="annot"><span class="annottext">msg :: Echo
</span><a href="#local-6989586621679202869"><span class="hs-identifier hs-var">msg</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Echo) -&gt; Echo -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Echo)
Prism' Response'Value ResponseEcho
</span><span class="hs-identifier hs-var">PT._Response'Echo</span></span><span> </span><span class="annot"><span class="annottext">Echo
</span><a href="#local-6989586621679202869"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseFlush"><span class="hs-identifier hs-type">ResponseFlush</span></a></span><span> </span><span id="local-6989586621679202866"><span class="annot"><span class="annottext">msg :: Flush
</span><a href="#local-6989586621679202866"><span class="hs-identifier hs-var">msg</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Flush) -&gt; Flush -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Flush)
Prism' Response'Value ResponseFlush
</span><span class="hs-identifier hs-var">PT._Response'Flush</span></span><span> </span><span class="annot"><span class="annottext">Flush
</span><a href="#local-6989586621679202866"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInfo"><span class="hs-identifier hs-type">ResponseInfo</span></a></span><span> </span><span id="local-6989586621679202864"><span class="annot"><span class="annottext">msg :: Info
</span><a href="#local-6989586621679202864"><span class="hs-identifier hs-var">msg</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Info) -&gt; Info -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Info)
Prism' Response'Value ResponseInfo
</span><span class="hs-identifier hs-var">PT._Response'Info</span></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679202864"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseSetOption"><span class="hs-identifier hs-type">ResponseSetOption</span></a></span><span> </span><span id="local-6989586621679202862"><span class="annot"><span class="annottext">msg :: SetOption
</span><a href="#local-6989586621679202862"><span class="hs-identifier hs-var">msg</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped SetOption)
-&gt; SetOption -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped SetOption)
Prism' Response'Value ResponseSetOption
</span><span class="hs-identifier hs-var">PT._Response'SetOption</span></span><span> </span><span class="annot"><span class="annottext">SetOption
</span><a href="#local-6989586621679202862"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseInitChain"><span class="hs-identifier hs-type">ResponseInitChain</span></a></span><span> </span><span id="local-6989586621679202860"><span class="annot"><span class="annottext">msg :: InitChain
</span><a href="#local-6989586621679202860"><span class="hs-identifier hs-var">msg</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped InitChain)
-&gt; InitChain -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped InitChain)
Prism' Response'Value ResponseInitChain
</span><span class="hs-identifier hs-var">PT._Response'InitChain</span></span><span> </span><span class="annot"><span class="annottext">InitChain
</span><a href="#local-6989586621679202860"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseQuery"><span class="hs-identifier hs-type">ResponseQuery</span></a></span><span> </span><span id="local-6989586621679202858"><span class="annot"><span class="annottext">msg :: Query
</span><a href="#local-6989586621679202858"><span class="hs-identifier hs-var">msg</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Query) -&gt; Query -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Query)
Prism' Response'Value ResponseQuery
</span><span class="hs-identifier hs-var">PT._Response'Query</span></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679202858"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseBeginBlock"><span class="hs-identifier hs-type">ResponseBeginBlock</span></a></span><span> </span><span id="local-6989586621679202856"><span class="annot"><span class="annottext">msg :: BeginBlock
</span><a href="#local-6989586621679202856"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped BeginBlock)
-&gt; BeginBlock -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped BeginBlock)
Prism' Response'Value ResponseBeginBlock
</span><span class="hs-identifier hs-var">PT._Response'BeginBlock</span></span><span> </span><span class="annot"><span class="annottext">BeginBlock
</span><a href="#local-6989586621679202856"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCheckTx"><span class="hs-identifier hs-type">ResponseCheckTx</span></a></span><span> </span><span id="local-6989586621679202854"><span class="annot"><span class="annottext">msg :: CheckTx
</span><a href="#local-6989586621679202854"><span class="hs-identifier hs-var">msg</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped CheckTx) -&gt; CheckTx -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped CheckTx)
Prism' Response'Value ResponseCheckTx
</span><span class="hs-identifier hs-var">PT._Response'CheckTx</span></span><span> </span><span class="annot"><span class="annottext">CheckTx
</span><a href="#local-6989586621679202854"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseDeliverTx"><span class="hs-identifier hs-type">ResponseDeliverTx</span></a></span><span> </span><span id="local-6989586621679202852"><span class="annot"><span class="annottext">msg :: DeliverTx
</span><a href="#local-6989586621679202852"><span class="hs-identifier hs-var">msg</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped DeliverTx)
-&gt; DeliverTx -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped DeliverTx)
Prism' Response'Value ResponseDeliverTx
</span><span class="hs-identifier hs-var">PT._Response'DeliverTx</span></span><span> </span><span class="annot"><span class="annottext">DeliverTx
</span><a href="#local-6989586621679202852"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseEndBlock"><span class="hs-identifier hs-type">ResponseEndBlock</span></a></span><span> </span><span id="local-6989586621679202850"><span class="annot"><span class="annottext">msg :: EndBlock
</span><a href="#local-6989586621679202850"><span class="hs-identifier hs-var">msg</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped EndBlock) -&gt; EndBlock -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped EndBlock)
Prism' Response'Value ResponseEndBlock
</span><span class="hs-identifier hs-var">PT._Response'EndBlock</span></span><span> </span><span class="annot"><span class="annottext">EndBlock
</span><a href="#local-6989586621679202850"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseCommit"><span class="hs-identifier hs-type">ResponseCommit</span></a></span><span> </span><span id="local-6989586621679202848"><span class="annot"><span class="annottext">msg :: Commit
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">msg</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Commit) -&gt; Commit -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Commit)
Prism' Response'Value ResponseCommit
</span><span class="hs-identifier hs-var">PT._Response'Commit</span></span><span> </span><span class="annot"><span class="annottext">Commit
</span><a href="#local-6989586621679202848"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="Network.ABCI.Server.App.html#ResponseException"><span class="hs-identifier hs-type">ResponseException</span></a></span><span> </span><span id="local-6989586621679202846"><span class="annot"><span class="annottext">msg :: Exception
</span><a href="#local-6989586621679202846"><span class="hs-identifier hs-var">msg</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Exception)
-&gt; Exception -&gt; Response
forall b b s.
(Message b, HasField b &quot;maybe'value&quot; (Maybe b), Wrapped s) =&gt;
AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AReview Response'Value (Unwrapped Exception)
Prism' Response'Value ResponseException
</span><span class="hs-identifier hs-var">PT._Response'Exception</span></span><span> </span><span class="annot"><span class="annottext">Exception
</span><a href="#local-6989586621679202846"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679202868"><span class="annot"><span class="annottext">wrap :: AReview b (Unwrapped s) -&gt; s -&gt; b
</span><a href="#local-6989586621679202868"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679202844"><span class="annot"><span class="annottext">v :: AReview b (Unwrapped s)
</span><a href="#local-6989586621679202844"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679202843"><span class="annot"><span class="annottext">msg :: s
</span><a href="#local-6989586621679202843"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
forall msg. Message msg =&gt; msg
</span><span class="hs-identifier hs-var">defMessage</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">LensLike' Identity b (Maybe b)
forall (f :: * -&gt; *) s a.
(Functor f, HasField s &quot;maybe'value&quot; a) =&gt;
LensLike' f s a
</span><span class="hs-identifier hs-var">PT.maybe'value</span></span><span> </span><span class="annot"><span class="annottext">LensLike' Identity b (Maybe b) -&gt; b -&gt; b -&gt; b
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">AReview b (Unwrapped s)
</span><a href="#local-6989586621679202844"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">AReview b (Unwrapped s) -&gt; Unwrapped s -&gt; b
forall t b. AReview t b -&gt; b -&gt; t
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679202843"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Getting (Unwrapped s) s (Unwrapped s) -&gt; Unwrapped s
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Unwrapped s) s (Unwrapped s)
forall s. Wrapped s =&gt; Iso' s (Unwrapped s)
</span><span class="hs-identifier hs-var">_Wrapped'</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Application type that represents a well typed application, i.e. a</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- function from a typed `Request` to a typed `Response`.</span><span>
</span><span id="line-288"></span><span class="hs-keyword">newtype</span><span> </span><span id="App"><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span> </span><span id="local-6989586621679203238"><span class="annot"><a href="#local-6989586621679203238"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="App"><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unApp"><span class="annot"><span class="annottext">App m -&gt; forall (t :: MessageType). Request t -&gt; m (Response t)
</span><a href="Network.ABCI.Server.App.html#unApp"><span class="hs-identifier hs-var hs-var">unApp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203242"><span class="annot"><a href="#local-6989586621679203242"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203242"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679203238"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203242"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Middleware is a component that sits between the server and application.</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- It can do such tasks as logging or response caching. What follows is the general</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- definition of middleware, though a middleware author should feel free to modify this.</span><span>
</span><span id="line-294"></span><span class="hs-keyword">type</span><span> </span><span id="Middleware"><span class="annot"><a href="Network.ABCI.Server.App.html#Middleware"><span class="hs-identifier hs-var">Middleware</span></a></span></span><span> </span><span id="local-6989586621679202839"><span class="annot"><a href="#local-6989586621679202839"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202839"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202839"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Transform an application from running in a custom monad to running in `IO`.</span><span>
</span><span id="line-297"></span><span id="local-6989586621679202837"><span id="local-6989586621679202838"><span class="annot"><a href="Network.ABCI.Server.App.html#transformApp"><span class="hs-identifier hs-type">transformApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203240"><span class="annot"><a href="#local-6989586621679203240"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#MessageType"><span class="hs-identifier hs-type">MessageType</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679202838"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203240"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202837"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203240"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202838"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202837"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-298"></span><span id="transformApp"><span class="annot"><span class="annottext">transformApp :: (forall (t :: MessageType). m (Response t) -&gt; g (Response t))
-&gt; App m -&gt; App g
</span><a href="Network.ABCI.Server.App.html#transformApp"><span class="hs-identifier hs-var hs-var">transformApp</span></a></span></span><span> </span><span id="local-6989586621679202836"><span class="annot"><span class="annottext">nat :: forall (t :: MessageType). m (Response t) -&gt; g (Response t)
</span><a href="#local-6989586621679202836"><span class="hs-identifier hs-var">nat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679202835"><span class="annot"><span class="annottext">f :: forall (t :: MessageType). Request t -&gt; m (Response t)
</span><a href="#local-6989586621679202835"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (t :: MessageType). Request t -&gt; g (Response t)) -&gt; App g
forall (m :: * -&gt; *).
(forall (t :: MessageType). Request t -&gt; m (Response t)) -&gt; App m
</span><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (t :: MessageType). Request t -&gt; g (Response t)) -&gt; App g)
-&gt; (forall (t :: MessageType). Request t -&gt; g (Response t))
-&gt; App g
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (Response t) -&gt; g (Response t)
forall (t :: MessageType). m (Response t) -&gt; g (Response t)
</span><a href="#local-6989586621679202836"><span class="hs-identifier hs-var">nat</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Response t) -&gt; g (Response t))
-&gt; (Request t -&gt; m (Response t)) -&gt; Request t -&gt; g (Response t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Request t -&gt; m (Response t)
forall (t :: MessageType). Request t -&gt; m (Response t)
</span><a href="#local-6989586621679202835"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Compiles `App` down to `AppBS`</span><span>
</span><span id="line-301"></span><span class="annot"><a href="Network.ABCI.Server.App.html#runApp"><span class="hs-identifier hs-type">runApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679202834"><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-type">LPByteStrings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-type">LPByteStrings</span></a></span><span>
</span><span id="line-302"></span><span id="runApp"><span class="annot"><span class="annottext">runApp :: App m -&gt; LPByteStrings -&gt; m LPByteStrings
</span><a href="Network.ABCI.Server.App.html#runApp"><span class="hs-identifier hs-var hs-var">runApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679202833"><span class="annot"><span class="annottext">app :: forall (t :: MessageType). Request t -&gt; m (Response t)
</span><a href="#local-6989586621679202833"><span class="hs-identifier hs-var">app</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679202832"><span class="annot"><span class="annottext">bs :: LPByteStrings
</span><a href="#local-6989586621679202832"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">LPByteStrings
</span><a href="#local-6989586621679202832"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">LPByteStrings
-&gt; (LPByteStrings -&gt; Either DecodeError [Request'Value])
-&gt; Either DecodeError [Request'Value]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LPByteStrings -&gt; Either DecodeError [ByteString]
</span><a href="Network.ABCI.Server.App.html#decodeLengthPrefix"><span class="hs-identifier hs-var">decodeLengthPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">(LPByteStrings -&gt; Either DecodeError [ByteString])
-&gt; ([ByteString] -&gt; Either DecodeError [Request'Value])
-&gt; LPByteStrings
-&gt; Either DecodeError [Request'Value]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Either DecodeError [Request'Value]
</span><a href="#local-6989586621679202831"><span class="hs-identifier hs-var">decodeRequests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Either DecodeError [Request'Value]
-&gt; (Either DecodeError [Request'Value] -&gt; m [Response])
-&gt; m [Response]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DecodeError -&gt; m [Response])
-&gt; ([Request'Value] -&gt; m [Response])
-&gt; Either DecodeError [Request'Value]
-&gt; m [Response]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Response] -&gt; m [Response]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Response] -&gt; m [Response])
-&gt; (DecodeError -&gt; [Response]) -&gt; DecodeError -&gt; m [Response]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodeError -&gt; [Response]
</span><a href="#local-6989586621679202829"><span class="hs-identifier hs-var">onError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Request'Value -&gt; m Response) -&gt; [Request'Value] -&gt; m [Response]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Request'Value -&gt; m Response
</span><a href="#local-6989586621679202827"><span class="hs-identifier hs-var">onResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">m [Response]
-&gt; (m [Response] -&gt; m LPByteStrings) -&gt; m LPByteStrings
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([Response] -&gt; LPByteStrings) -&gt; m [Response] -&gt; m LPByteStrings
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; LPByteStrings
</span><a href="Network.ABCI.Server.App.html#encodeLengthPrefix"><span class="hs-identifier hs-var">encodeLengthPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; LPByteStrings)
-&gt; ([Response] -&gt; [ByteString]) -&gt; [Response] -&gt; LPByteStrings
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Response] -&gt; [ByteString]
</span><a href="#local-6989586621679202826"><span class="hs-identifier hs-var">encodeResponses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="#local-6989586621679202829"><span class="hs-identifier hs-type">onError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html#DecodeError"><span class="hs-identifier hs-type">DecodeError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PT.Response</span></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679202829"><span class="annot"><span class="annottext">onError :: DecodeError -&gt; [Response]
</span><a href="#local-6989586621679202829"><span class="hs-identifier hs-var hs-var">onError</span></a></span></span><span> </span><span id="local-6989586621679202825"><span class="annot"><span class="annottext">err :: DecodeError
</span><a href="#local-6989586621679202825"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Response Any -&gt; Response
forall (t :: MessageType). Response t -&gt; Response
</span><a href="Network.ABCI.Server.App.html#toProto"><span class="hs-identifier hs-var">toProto</span></a></span><span> </span><span class="annot"><span class="annottext">(Response Any -&gt; Response) -&gt; Response Any -&gt; Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exception -&gt; Response Any
forall (m :: MessageType). Exception -&gt; Response m
</span><a href="Network.ABCI.Server.App.html#ResponseException"><span class="hs-identifier hs-var">ResponseException</span></a></span><span> </span><span class="annot"><span class="annottext">(Exception -&gt; Response Any) -&gt; Exception -&gt; Response Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exception
</span><span class="hs-identifier hs-var">Response.Exception</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Exception) -&gt; Text -&gt; Exception
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a b. ConvertibleStrings a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">cs</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DecodeError -&gt; String
</span><a href="Network.ABCI.Server.App.DecodeError.html#print"><span class="hs-identifier hs-var">DecodeError.print</span></a></span><span> </span><span class="annot"><span class="annottext">DecodeError
</span><a href="#local-6989586621679202825"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621679202827"><span class="hs-identifier hs-type">onResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679202834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PT.Response</span></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679202827"><span class="annot"><span class="annottext">onResponse :: Request'Value -&gt; m Response
</span><a href="#local-6989586621679202827"><span class="hs-identifier hs-var hs-var">onResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (t :: MessageType). Request t -&gt; m Response)
-&gt; Request'Value -&gt; m Response
forall a.
(forall (t :: MessageType). Request t -&gt; a) -&gt; Request'Value -&gt; a
</span><a href="Network.ABCI.Server.App.html#withProto"><span class="hs-identifier hs-var">withProto</span></a></span><span> </span><span class="annot"><span class="annottext">((forall (t :: MessageType). Request t -&gt; m Response)
 -&gt; Request'Value -&gt; m Response)
-&gt; (forall (t :: MessageType). Request t -&gt; m Response)
-&gt; Request'Value
-&gt; m Response
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Response t -&gt; Response) -&gt; m (Response t) -&gt; m Response
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Response t -&gt; Response
forall (t :: MessageType). Response t -&gt; Response
</span><a href="Network.ABCI.Server.App.html#toProto"><span class="hs-identifier hs-var">toProto</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Response t) -&gt; m Response)
-&gt; (Request t -&gt; m (Response t)) -&gt; Request t -&gt; m Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Request t -&gt; m (Response t)
forall (t :: MessageType). Request t -&gt; m (Response t)
</span><a href="#local-6989586621679202833"><span class="hs-identifier hs-var">app</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- | Encodes responses to bytestrings</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621679202826"><span class="hs-identifier hs-type">encodeResponses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PT.Response</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679202826"><span class="annot"><span class="annottext">encodeResponses :: [Response] -&gt; [ByteString]
</span><a href="#local-6989586621679202826"><span class="hs-identifier hs-var hs-var">encodeResponses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Response -&gt; ByteString) -&gt; [Response] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; ByteString
forall msg. Message msg =&gt; msg -&gt; ByteString
</span><span class="hs-identifier hs-var">PL.encodeMessage</span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-comment">-- | Decodes bytestrings into requests</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="#local-6989586621679202831"><span class="hs-identifier hs-type">decodeRequests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html#DecodeError"><span class="hs-identifier hs-type">DecodeError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PT.Request'Value</span></span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679202831"><span class="annot"><span class="annottext">decodeRequests :: [ByteString] -&gt; Either DecodeError [Request'Value]
</span><a href="#local-6989586621679202831"><span class="hs-identifier hs-var hs-var">decodeRequests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either DecodeError Request'Value)
-&gt; [ByteString] -&gt; Either DecodeError [Request'Value]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((ByteString -&gt; Either DecodeError Request'Value)
 -&gt; [ByteString] -&gt; Either DecodeError [Request'Value])
-&gt; (ByteString -&gt; Either DecodeError Request'Value)
-&gt; [ByteString]
-&gt; Either DecodeError [Request'Value]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679202822"><span class="annot"><span class="annottext">packet :: ByteString
</span><a href="#local-6989586621679202822"><span class="hs-identifier hs-var">packet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String Request
forall msg. Message msg =&gt; ByteString -&gt; Either String msg
</span><span class="hs-identifier hs-var">PL.decodeMessage</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202822"><span class="hs-identifier hs-var">packet</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679202820"><span class="annot"><span class="annottext">parseError :: String
</span><a href="#local-6989586621679202820"><span class="hs-identifier hs-var">parseError</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DecodeError -&gt; Either DecodeError Request'Value
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(DecodeError -&gt; Either DecodeError Request'Value)
-&gt; DecodeError -&gt; Either DecodeError Request'Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String -&gt; DecodeError
</span><a href="Network.ABCI.Server.App.DecodeError.html#CanNotDecodeRequest"><span class="hs-identifier hs-var">DecodeError.CanNotDecodeRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202822"><span class="hs-identifier hs-var">packet</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679202820"><span class="hs-identifier hs-var">parseError</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202818"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679202818"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PT.Request</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679202818"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Request
-&gt; Getting (Maybe Request'Value) Request (Maybe Request'Value)
-&gt; Maybe Request'Value
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe Request'Value) Request (Maybe Request'Value)
forall (f :: * -&gt; *) s a.
(Functor f, HasField s &quot;maybe'value&quot; a) =&gt;
LensLike' f s a
</span><span class="hs-identifier hs-var">PT.maybe'value</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DecodeError -&gt; Either DecodeError Request'Value
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(DecodeError -&gt; Either DecodeError Request'Value)
-&gt; DecodeError -&gt; Either DecodeError Request'Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FieldSet -&gt; DecodeError
</span><a href="Network.ABCI.Server.App.DecodeError.html#NoValueInRequest"><span class="hs-identifier hs-var">DecodeError.NoValueInRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202822"><span class="hs-identifier hs-var">packet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679202818"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Getting FieldSet Request FieldSet -&gt; FieldSet
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting FieldSet Request FieldSet
forall msg. Message msg =&gt; Lens' msg FieldSet
</span><span class="hs-identifier hs-var">PL.unknownFields</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679202815"><span class="annot"><span class="annottext">value :: Request'Value
</span><a href="#local-6989586621679202815"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request'Value -&gt; Either DecodeError Request'Value
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Request'Value -&gt; Either DecodeError Request'Value)
-&gt; Request'Value -&gt; Either DecodeError Request'Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request'Value
</span><a href="#local-6989586621679202815"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | ByteString which contains multiple length prefixed ByteStrings</span><span>
</span><span id="line-328"></span><span class="hs-keyword">newtype</span><span> </span><span id="LPByteStrings"><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-var">LPByteStrings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LPByteStrings"><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-var">LPByteStrings</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unLPByteStrings"><span class="annot"><span class="annottext">LPByteStrings -&gt; ByteString
</span><a href="Network.ABCI.Server.App.html#unLPByteStrings"><span class="hs-identifier hs-var hs-var">unLPByteStrings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202798"><span id="local-6989586621679202800"><span id="local-6989586621679202802"><span id="local-6989586621679202804"><span id="local-6989586621679202806"><span id="local-6989586621679202808"><span id="local-6989586621679202810"><span class="annot"><span class="annottext">Eq LPByteStrings
Eq LPByteStrings =&gt;
(LPByteStrings -&gt; LPByteStrings -&gt; Ordering)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; Bool)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; Bool)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; Bool)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; Bool)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings)
-&gt; Ord LPByteStrings
LPByteStrings -&gt; LPByteStrings -&gt; Bool
LPByteStrings -&gt; LPByteStrings -&gt; Ordering
LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings
$cmin :: LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings
max :: LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings
$cmax :: LPByteStrings -&gt; LPByteStrings -&gt; LPByteStrings
&gt;= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c&gt;= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
&gt; :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c&gt; :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
&lt;= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c&lt;= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
&lt; :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c&lt; :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
compare :: LPByteStrings -&gt; LPByteStrings -&gt; Ordering
$ccompare :: LPByteStrings -&gt; LPByteStrings -&gt; Ordering
$cp1Ord :: Eq LPByteStrings
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679202794"><span id="local-6989586621679202796"><span class="annot"><span class="annottext">LPByteStrings -&gt; LPByteStrings -&gt; Bool
(LPByteStrings -&gt; LPByteStrings -&gt; Bool)
-&gt; (LPByteStrings -&gt; LPByteStrings -&gt; Bool) -&gt; Eq LPByteStrings
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c/= :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
== :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
$c== :: LPByteStrings -&gt; LPByteStrings -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | Encodes ByteStrings into varlength-prefixed ByteString</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Network.ABCI.Server.App.html#encodeLengthPrefix"><span class="hs-identifier hs-type">encodeLengthPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-type">LPByteStrings</span></a></span><span>
</span><span id="line-332"></span><span id="encodeLengthPrefix"><span class="annot"><span class="annottext">encodeLengthPrefix :: [ByteString] -&gt; LPByteStrings
</span><a href="Network.ABCI.Server.App.html#encodeLengthPrefix"><span class="hs-identifier hs-var hs-var">encodeLengthPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LPByteStrings
</span><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-var">LPByteStrings</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; LPByteStrings)
-&gt; ([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; LPByteStrings
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679202792"><span class="hs-identifier hs-var">encoder</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679202792"><span class="annot"><span class="annottext">encoder :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679202792"><span class="hs-identifier hs-var hs-var">encoder</span></a></span></span><span> </span><span id="local-6989586621679202791"><span class="annot"><span class="annottext">bytes :: ByteString
</span><a href="#local-6989586621679202791"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621679202790"><span class="annot"><span class="annottext">headerN :: Word64
</span><a href="#local-6989586621679202790"><span class="hs-identifier hs-var hs-var">headerN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Word64
</span><span class="hs-identifier hs-var">signedInt64ToWord</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Word64) -&gt; (ByteString -&gt; Int64) -&gt; ByteString -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; (ByteString -&gt; Int) -&gt; ByteString -&gt; Int64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Word64) -&gt; ByteString -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202791"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span id="local-6989586621679202788"><span class="annot"><span class="annottext">header :: ByteString
</span><a href="#local-6989586621679202788"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">runBuilder</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
</span><span class="hs-identifier hs-var">putVarInt</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679202790"><span class="hs-identifier hs-var">headerN</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202788"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202791"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Decodes varlength-prefixed ByteString into ByteStrings</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Network.ABCI.Server.App.html#decodeLengthPrefix"><span class="hs-identifier hs-type">decodeLengthPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-type">LPByteStrings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.ABCI.Server.App.DecodeError.html#DecodeError"><span class="hs-identifier hs-type">DecodeError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-343"></span><span id="decodeLengthPrefix"><span class="annot"><span class="annottext">decodeLengthPrefix :: LPByteStrings -&gt; Either DecodeError [ByteString]
</span><a href="Network.ABCI.Server.App.html#decodeLengthPrefix"><span class="hs-identifier hs-var hs-var">decodeLengthPrefix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-type">LPByteStrings</span></a></span><span> </span><span id="local-6989586621679202786"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Either DecodeError [ByteString]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>      </span><span id="local-6989586621679202785"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679202785"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String -&gt; DecodeError)
-&gt; Either String Word64 -&gt; Either DecodeError Word64
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String -&gt; DecodeError
</span><a href="Network.ABCI.Server.App.DecodeError.html#ProtoLensParseError"><span class="hs-identifier hs-var">DecodeError.ProtoLensParseError</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String Word64 -&gt; Either DecodeError Word64)
-&gt; Either String Word64 -&gt; Either DecodeError Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser Word64 -&gt; ByteString -&gt; Either String Word64
forall a. Parser a -&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="annot"><span class="annottext">Parser Word64
</span><span class="hs-identifier hs-var">getVarInt</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679202783"><span class="annot"><span class="annottext">lengthHeader :: ByteString
</span><a href="#local-6989586621679202783"><span class="hs-identifier hs-var hs-var">lengthHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">runBuilder</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Builder
</span><span class="hs-identifier hs-var">putVarInt</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679202785"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span id="local-6989586621679202782"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202782"><span class="hs-identifier hs-var">messageBytesWithTail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">BS.stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202783"><span class="hs-identifier hs-var">lengthHeader</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DecodeError -&gt; Either DecodeError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(DecodeError -&gt; Either DecodeError ByteString)
-&gt; DecodeError -&gt; Either DecodeError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; DecodeError
</span><a href="Network.ABCI.Server.App.DecodeError.html#InvalidPrefix"><span class="hs-identifier hs-var">DecodeError.InvalidPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202783"><span class="hs-identifier hs-var">lengthHeader</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202786"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679202779"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679202779"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either DecodeError ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202779"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679202778"><span class="annot"><span class="annottext">messageBytes :: ByteString
</span><a href="#local-6989586621679202778"><span class="hs-identifier hs-var">messageBytes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679202777"><span class="annot"><span class="annottext">remainder :: ByteString
</span><a href="#local-6989586621679202777"><span class="hs-identifier hs-var">remainder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Int) -&gt; Int64 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int64
</span><span class="hs-identifier hs-var">wordToSignedInt64</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679202785"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202782"><span class="hs-identifier hs-var">messageBytesWithTail</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202778"><span class="hs-identifier hs-var">messageBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; Either DecodeError [ByteString]
-&gt; Either DecodeError [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LPByteStrings -&gt; Either DecodeError [ByteString]
</span><a href="Network.ABCI.Server.App.html#decodeLengthPrefix"><span class="hs-identifier hs-var">decodeLengthPrefix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; LPByteStrings
</span><a href="Network.ABCI.Server.App.html#LPByteStrings"><span class="hs-identifier hs-var">LPByteStrings</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679202777"><span class="hs-identifier hs-var">remainder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span></pre></body></html>